<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Men√∫ - Pupuser√≠a Las Tuks</title>
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
  />
  <style>
    body {
      background: linear-gradient(135deg, #1b1b1b, #2c2c2c);
      color: white;
      font-family: "Poppins", sans-serif;
      padding: 20px;
    }

    .menu-container {
      max-width: 800px;
      margin: auto;
      background-color: rgba(255, 255, 255, 0.08);
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.15);
    }

    h1 {
      text-align: center;
      color: #ffb703;
      font-weight: 600;
      margin-bottom: 25px;
    }

    .pupusa-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      background-color: rgba(255, 255, 255, 0.05);
      padding: 10px 15px;
      margin: 10px 0;
      border-radius: 8px;
    }

    .btn-agregar {
      background-color: #219ebc;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 5px 10px;
      transition: background 0.3s;
    }

    .btn-agregar:hover {
      background-color: #126782;
    }

    .btn-pedido {
      background-color: #ffb703;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      color: black;
      font-weight: bold;
      transition: background 0.3s;
    }

    .btn-pedido:hover {
      background-color: #f48c06;
    }

    .pedido-box {
      background-color: rgba(255, 255, 255, 0.08);
      padding: 15px;
      border-radius: 10px;
      margin-top: 20px;
    }

    .alert {
      text-align: center;
      font-weight: bold;
    }
  </style>
</head>
<body>
  <div class="menu-container">
    <h1>ü•ü Men√∫ de Pupuser√≠a Las Tuks</h1>

    <div id="mensaje"></div>

    <div class="mb-3">
      <label for="nombreCliente" class="form-label">Tu nombre:</label>
      <input type="text" id="nombreCliente" class="form-control" placeholder="Escribe tu nombre" />
    </div>

    <div id="menu-lista">
      <div class="pupusa-item">
        <span>Pupusa de queso - $1.00</span>
        <button class="btn-agregar" onclick="agregar('Pupusa de queso', 1.00)">Agregar</button>
      </div>
      <div class="pupusa-item">
        <span>Pupusa de frijol con queso - $1.25</span>
        <button class="btn-agregar" onclick="agregar('Pupusa de frijol con queso', 1.25)">Agregar</button>
      </div>
      <div class="pupusa-item">
        <span>Pupusa revuelta - $1.50</span>
        <button class="btn-agregar" onclick="agregar('Pupusa revuelta', 1.50)">Agregar</button>
      </div>
      <div class="pupusa-item">
        <span>Pupusa de ajo - $1.25</span>
        <button class="btn-agregar" onclick="agregar('Pupusa de ajo', 1.25)">Agregar</button>
      </div>
      <div class="pupusa-item">
        <span>Pupusa de pollo con queso - $1.75</span>
        <button class="btn-agregar" onclick="agregar('Pupusa de pollo con queso', 1.75)">Agregar</button>
      </div>
    </div>

    <div class="pedido-box">
      <h4>üßæ Tu pedido:</h4>
      <ul id="lista-pedido"></ul>
      <p><strong>Total:</strong> $<span id="total">0.00</span></p>

      <button class="btn-pedido" onclick="realizarPedido()">Realizar pedido</button>
    </div>
  </div>

  <script>
    let pedido = [];
    let total = 0;

    function agregar(nombre, precio) {
      pedido.push({ nombre, precio });
      total += precio;
      actualizarPedido();
    }

    function actualizarPedido() {
      const lista = document.getElementById("lista-pedido");
      lista.innerHTML = "";
      pedido.forEach((item) => {
        const li = document.createElement("li");
        li.textContent = `${item.nombre} - $${item.precio.toFixed(2)}`;
        lista.appendChild(li);
      });
      document.getElementById("total").textContent = total.toFixed(2);
    }

    async function realizarPedido() {
      const cliente = document.getElementById("nombreCliente").value.trim();

      if (cliente === "" || pedido.length === 0) {
        mostrarMensaje("‚ùå Ingresa tu nombre y agrega al menos una pupusa.", "danger");
        return;
      }

      const pedidoTexto = pedido.map(p => p.nombre).join(", ");

      const res = await fetch("/realizar_pedido", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
          cliente: cliente,
          pedido: pedidoTexto,
          total: total
        })
      });

      if (res.ok) {
        mostrarMensaje("‚úÖ ¬°Pedido realizado con √©xito! üéâ", "success");
        pedido = [];
        total = 0;
        actualizarPedido();
        document.getElementById("nombreCliente").value = "";
      } else {
        mostrarMensaje("‚ö†Ô∏è Error al enviar el pedido. Intenta de nuevo.", "danger");
      }
    }

    function mostrarMensaje(texto, tipo) {
      const mensaje = document.getElementById("mensaje");
      mensaje.innerHTML = `<div class="alert alert-${tipo}" role="alert">${texto}</div>`;
      setTimeout(() => mensaje.innerHTML = "", 4000);
    }
  </script>
</body>
</html>
