<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Las Tuks - Men√∫</title>
    <style>
        body {
            background: url("{{ url_for('static', filename='tuks-img.png') }}") no-repeat center center fixed;
            background-size: cover;
            color: #fff;
            font-family: Arial, sans-serif;
            text-align: center;
        }
        .menu {
            background-color: rgba(0,0,0,0.7);
            border-radius: 15px;
            display: inline-block;
            padding: 20px;
            margin-top: 80px;
        }
        .item {
            margin: 15px;
            padding: 10px;
            background: #f8f8f8;
            color: black;
            border-radius: 10px;
        }
        button { margin: 5px; }
    </style>
</head>
<body>
    <div class="menu">
        <h1>üçΩ Pupuser√≠a Las Tuks üçΩ</h1>
        <div id="items">
            <div class="item">
                <h3>Pupusa de Queso - $1.00</h3>
                <button onclick="cambiarCantidad('queso', -1)">-</button>
                <span id="queso">0</span>
                <button onclick="cambiarCantidad('queso', 1)">+</button>
            </div>
            <div class="item">
                <h3>Pupusa Revueltas - $1.25</h3>
                <button onclick="cambiarCantidad('revueltas', -1)">-</button>
                <span id="revueltas">0</span>
                <button onclick="cambiarCantidad('revueltas', 1)">+</button>
            </div>
            <div class="item">
                <h3>Pupusa de Frijol con Queso - $1.10</h3>
                <button onclick="cambiarCantidad('frijol', -1)">-</button>
                <span id="frijol">0</span>
                <button onclick="cambiarCantidad('frijol', 1)">+</button>
            </div>
        </div>

        <p><strong>Total: $<span id="total">0.00</span></strong></p>

        <input type="text" id="nombre" placeholder="Tu nombre"><br><br>
        <input type="text" id="telefono" placeholder="Tu tel√©fono"><br><br>

        <button onclick="enviarPedido()">Realizar Pedido</button>
    </div>

    <script>
        const precios = { queso: 1.00, revueltas: 1.25, frijol: 1.10 };

        function cambiarCantidad(tipo, cambio) {
            const span = document.getElementById(tipo);
            let cantidad = parseInt(span.textContent) + cambio;
            if (cantidad < 0) cantidad = 0;
            span.textContent = cantidad;
            calcularTotal();
        }

        function calcularTotal() {
            let total = 0;
            for (let tipo in precios) {
                total += precios[tipo] * parseInt(document.getElementById(tipo).textContent);
            }
            document.getElementById("total").textContent = total.toFixed(2);
        }

        function enviarPedido() {
            const nombre = document.getElementById("nombre").value;
            const telefono = document.getElementById("telefono").value;
            const total = parseFloat(document.getElementById("total").textContent);

            if (!nombre || !telefono || total === 0) {
                alert("Por favor completa todos los campos y selecciona al menos un producto.");
                return;
            }

            const items = {
                queso: document.getElementById("queso").textContent,
                revueltas: document.getElementById("revueltas").textContent,
                frijol: document.getElementById("frijol").textContent
            };

            fetch("/pedido", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ nombre, telefono, items, total })
            })
            .then(res => res.json())
            .then(data => {
                alert(data.message);
                window.location.reload();
            });
        }
    </script>
</body>
</html>
